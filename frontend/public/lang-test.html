<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Language Detection Test</title>
</head>
<body>
    <h1>Language Detection Test</h1>
    <div id="output"></div>
    
    <script>
        // Simulate the language detection logic
        const getSystemLanguage = () => {
            const systemLang = navigator.language || navigator.languages?.[0] || 'en'
            
            if (systemLang.startsWith('zh')) {
                return 'zh-CN'
            }
            
            return 'en'
        }
        
        const getSavedLanguage = () => {
            const savedLang = localStorage.getItem('locale')
            if (savedLang) {
                return savedLang
            }
            
            return getSystemLanguage()
        }
        
        // Test the functionality
        const systemLang = navigator.language || navigator.languages?.[0] || 'en'
        const detectedLang = getSystemLanguage()
        const savedLang = getSavedLanguage()
        
        const output = document.getElementById('output')
        output.innerHTML = `
            <h2>Language Detection Results:</h2>
            <p><strong>Browser Language:</strong> ${systemLang}</p>
            <p><strong>Detected App Language:</strong> ${detectedLang}</p>
            <p><strong>Current App Language:</strong> ${savedLang}</p>
            <p><strong>Has Saved Language:</strong> ${localStorage.getItem('locale') ? 'Yes' : 'No'}</p>
            
            <h3>Test Cases:</h3>
            <div id="tests"></div>
        `
        
        // Test various language codes
        const testCases = [
            'zh-CN', 'zh-TW', 'zh-HK', 'zh', 'en', 'en-US', 'en-GB', 'ja', 'ko', 'fr', 'de'
        ]
        
        const testsDiv = document.getElementById('tests')
        testCases.forEach(lang => {
            const originalLang = navigator.language
            const mockResult = lang.startsWith('zh') ? 'zh-CN' : 'en'
            testsDiv.innerHTML += `<p><strong>${lang}:</strong> ${mockResult}</p>`
        })
    </script>
</body>
</html>